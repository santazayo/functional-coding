### Advantages

> 카피 온 라이트 패턴은 무엇이 바뀌는지 알기 때문에 무엇을 복사해야 할지 예상할 수 있습니다.
신뢰할 수 없는 레거시 코드는 어떤 일이 일어날지 정확히 알 수 없어 데이터가 바뀌는 것을 완전히 막아주는 원칙이 필요합니다. 이 원칙을 방어적 복사라고 합니다.

#### 방어적 복사
방어적 복사는 안전지대의 경계에서 데이터가 오고 갈 때 사용합니다. 안전지대의 경계는 레거시 코드와 신뢰할 수 없는 코드가 만나는 지점입니다. 이 지점에서 데이터가 바뀌는 것을 막기 위해 방어적 복사를 사용합니다.

> 대부분의 웹 기반 API는 암묵적으로 방어적 복사를 합니다.
	
1.	클라이언트에서 데이터 전송 시: 원본 객체 → JSON 문자열 (직렬화) → 전송
2.	서버에서 데이터 수신 시: 수신된 JSON 문자열 → 새로운 객체 (역직렬화)
3.	서버에서 응답 전송 시: 처리된 객체 → JSON 문자열 (직렬화) → 전송
4.	클라이언트에서 응답 수신 시: 수신된 JSON 문자열 → 새로운 객체 (역직렬화)

데이터는 여러 번 변환되며, 각 단계마다 새로운 복사본이 생성됩니다. 결과적으로 원본 데이터의 무결성이 보장되고, 각 단계에서 데이터 조작이 독립적으로 이루어질 수 있습니다.

#### 비공유 아키텍처 (Shared Nothing Architecture)
모듈이 서로 통신하기 위해 방어적 복사를 구현했다면 비공유 아키텍처라고 합니다. 모듈이 어떤 데이터의 참조도 공유하고 있지 않기 때문입니다. 이 아키텍처는 모듈 간의 결합도를 낮추고 모듈을 독립적으로 만들어줍니다.

| 주제 | 카피 온 라이트 | 방어적 복사 |
|------|---------------|------------|
| 언제 사용하나요? | 통제할 수 있는 데이터를 바꿀 때 | 신뢰할 수 없는 코드와 데이터를 주고받을 때 |
| 어디서 쓰나요? | - 안전지대 어디서나 사용<br>- 카피 온 라이트가 불변성을 가진 안전지대를 만든다. | 안전지대의 경계에서 데이터가 오고 갈 때 |
| 복사 방식은? | 얕은 복사 | 깊은 복사 |
| 규칙 | 1. 바꿀 데이터의 얕은 복사본을 생성<br>2. 복사본 변경<br>3. 복사본 리턴 | 1. 안전지대로 들어오는 데이터에 깊은 복사를 만든다.<br>2. 안전지대에서 나가는 데이터에 깊은 복사를 만든다. |
